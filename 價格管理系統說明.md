# DeepVape 價格管理系統說明

## 問題解決

您遇到的「在CMS後台更改價格，前端沒有反應」的問題已經解決！

## 問題原因

您的網站原本有兩套獨立的價格系統：
1. **全域價格系統** (`data/prices.json`) - 用於首頁產品卡片
2. **個別產品頁面價格** (`data/page_products/*.json`) - 用於產品詳細頁面

這兩套系統沒有同步，導致在CMS後台更改價格後前端沒有反應。

## 解決方案

### 1. 新增全域價格管理功能

在CMS後台新增了「**全域價格管理**」功能：
- 位置：CMS後台 → 網站設定 → 全域價格管理
- 功能：統一管理所有產品的價格、原價和折扣標籤

### 2. 價格同步系統

新增了自動價格同步功能：
- **自動同步**：每30秒檢查一次價格是否需要同步
- **即時同步**：當頁面重新可見時自動檢查價格
- **手動同步**：提供手動同步功能

### 3. 增強的內容管理器

升級了 `content-manager.js`：
- 同時載入全域價格和產品頁面價格
- 自動同步價格差異
- 統一更新所有頁面的價格顯示

## 使用方法

### 更改產品價格

1. 登入CMS後台：`https://deepvape.org/admin/`
2. 進入「網站設定」→「全域價格管理」
3. 找到要更改的產品
4. 修改以下欄位：
   - **售價**：當前銷售價格
   - **原價**：劃線原價（可選）
   - **折扣標籤**：如「13% OFF」（可選）
5. 點擊「儲存」

### 價格同步確認

更改價格後，系統會自動：
1. 在30秒內檢測到價格變更
2. 同步到所有相關頁面
3. 更新首頁產品卡片和產品詳細頁面的價格顯示

### 手動同步（如需要）

如果需要立即同步價格，可以：
1. 開啟瀏覽器開發者工具（F12）
2. 在控制台輸入：`manualPriceSync()`
3. 按Enter執行

## 技術細節

### 新增文件
- `js/price-sync.js` - 價格同步管理器
- `admin/config.yml` - 新增全域價格管理配置

### 修改文件
- `js/content-manager.js` - 增強價格同步功能
- `index.html` - 引入價格同步腳本

### 價格同步邏輯
1. 以**全域價格**為準（`data/prices.json`）
2. 自動同步到**產品頁面價格**（`data/page_products/*.json`）
3. 統一更新前端顯示

## 監控和除錯

### 查看同步狀態
在瀏覽器控制台輸入：
```javascript
getPriceSyncStatus()
```

### 查看同步日誌
打開瀏覽器開發者工具，查看控制台日誌：
- ✅ 成功訊息：綠色勾號
- ⚠️ 警告訊息：黃色警告
- 🔄 同步訊息：藍色箭頭

## 注意事項

1. **統一管理**：現在只需要在「全域價格管理」中更改價格
2. **自動同步**：系統會自動處理價格同步，無需手動操作
3. **即時生效**：價格更改後最多30秒內生效
4. **備份建議**：重要價格更改前建議先備份

## 支援的產品

系統支援以下所有產品的價格管理：
- SP2 Device
- ILIA Gen1
- ILIA 5 Device
- ILIA Ultra5 Pods
- ILIA Leather
- ILIA Fabric
- HTA Vape
- ILIA Pods
- SP2 Pods
- HTA Pods
- LANA Pods
- ILIA Disposable
- LANA A8000

---

**問題已解決！** 現在您可以在CMS後台統一管理所有產品價格，系統會自動同步到前端顯示。 